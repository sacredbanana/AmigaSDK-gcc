/* clipboard.library example */
/* writing clipboard image    */
/* Michal Zukowski 2016  */

#define USE_INLINE_STDARG

#include <stdio.h>
#include <proto/exec.h>
#include <proto/dos.h>
#include <proto/clipboard.h>
#include <libraries/charsets.h>
#include <proto/multimedia.h>


//#define EXAMPLE_24BIT  // comment it to check ARGB32 support

#ifndef EXAMPLE_24BIT

// 8x8 ARGB32 image
ULONG MyImage[] = {
	0xFF000000, 0xFF000000, 0xFF000000, 0xFF000000, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF,
	0xFF000000, 0xFF000000, 0xFF000000, 0xFF000000, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF,
	0xFF000000, 0xFF000000, 0xFF000000, 0xFF000000, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF,
	0xFF000000, 0xFF000000, 0xFF000000, 0xFF000000, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF,
	0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFF000000, 0xFF000000, 0xFF000000, 0xFF000000,
	0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFF000000, 0xFF000000, 0xFF000000, 0xFF000000,
	0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFF000000, 0xFF000000, 0xFF000000, 0xFF000000,
	0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFF000000, 0xFF000000, 0xFF000000, 0xFF000000
};
LONG pixel_format = CLIPPIXFMT_ARGB32; 

#else

// 8x8 RGB24 image
UBYTE MyImage[] = {
	0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00, 0xFF,0x00,
	0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00, 0xFF,0x00,
	0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00, 0xFF,0x00,
	0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00, 0xFF,0x00,
    0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF, 0x00,0x00,
    0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF, 0x00,0x00,
    0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF, 0x00,0x00,
    0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF,0x00,0x00,0xFF, 0x00,0x00
};


LONG pixel_format = CLIPPIXFMT_RGB24;

#endif
//

struct Library *ClipboardBase;

int main(void)
{
	LONG cliperror;
	CONST_STRPTR fault;

	if ((ClipboardBase = OpenLibrary("clipboard.library", 53)))
	{
		LONG w = 8, h = 8;
		
		cliperror = WriteClipImage(
			CLP_Width,  w,  
			CLP_Height, h, 
			CLP_Format, pixel_format, 
			CLP_Data,   (IPTR)MyImage,
		TAG_END);

		fault = MediaFault(cliperror);
		printf("WriteClipImage() returned %ld: %s\n", cliperror, fault);
 
		CloseLibrary(ClipboardBase);
	}
	else
		Printf("Unable to open clipboard.library\n");

	return 0;
}