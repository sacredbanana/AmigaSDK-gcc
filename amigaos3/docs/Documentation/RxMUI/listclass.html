<html>

<head>
<title>List class</title>
</head>

<body>

<table border="0" width="100%">
  <tr>
    <td width="1" valign="bottom"><a href="classes.html"><font size="2">Index</font></a></td>
    <td width="1" valign="bottom"><a href="areaclass.html"><font size="2">Parent</font></a></td>
    <td><h2 align="right">List class</h2>
    </td>
  </tr>
  <tr>
    <td colspan="3"><hr size="1" noshade>
    </td>
  </tr>
</table>

<p>The List class is used to manipulate lists.</p>

<p>A list object is not a Listview: It is the object a Listview renders.</p>

<p>A List object can only be added to a Listview object at Listview creation time.</p>

<p>See <a href="listviewclass.html">Listview</a></p>

<p>&nbsp;</p>

<table border="1" cellpadding="4" width="100%">
  <tr>
    <th colspan="4"><u><strong>Attributes</strong></u></th>
  </tr>
  <tr>
    <th><em><strong>Name</strong></em></th>
    <th><em><strong>Type</strong></em></th>
    <th><em><strong>Class</strong></em></th>
    <th><em><strong>Note</strong></em></th>
  </tr>
  <tr>
    <td><strong>Active</strong></td>
    <td>M</td>
    <td>ISGN G2N</td>
    <td>A number or one of:<ul>
      <li>Bottom</li>
      <li>Down</li>
      <li>Off</li>
      <li>PageDown</li>
      <li>PageUp</li>
      <li>Top</li>
      <li>Up</li>
    </ul>
    </td>
  </tr>
  <tr>
    <td><strong>ActiveEntry</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>As Active, but as the value of the active entry</td>
  </tr>
  <tr>
    <td><strong>ActiveEntry0</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>The value of the columun number 0 of the active entry</td>
  </tr>
  <tr>
    <td><strong>ActiveEntry1</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>ActiveEntry2</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>ActiveEntry3</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>ActiveEntry4</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>ActiveEntry5</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>ActiveEntry6</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>ActiveEntry7</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>ActiveEntry8</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>ActiveEntry9</strong></td>
    <td>S</td>
    <td>GN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>AdjustHeight</strong></td>
    <td>B</td>
    <td>I</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>AdjustWidth</strong></td>
    <td>B</td>
    <td>I</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>AutoVisible</strong></td>
    <td>B</td>
    <td>ISG</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>Case</strong></td>
    <td>B</td>
    <td>I</td>
    <td>Sets case comparation mode (0 is the default)</td>
  </tr>
  <tr>
    <td><strong>DefaultInsertPos</strong></td>
    <td>M</td>
    <td>IS</td>
    <td>A number or one of: <ul>
     <li>Active</li>
     <li>Default (Default)</li>
     <li>Bottom</li>
     <li>Sorted</li>
     <li>Top</li></ul>
     Entries supplied at Init time or via AddStem or ClearAddStem
     are inserted at this position. If this attribute is not supplied or its value is Default,
     entries are inserted: <ul>
      <li>Sorted - if DragSortable is 1</li>
      <li>At the bottom - otherwise</li>
    </ul>See <a href="#Insertion">Insertion and Sorting</a></td>
  </tr>
  <tr>
    <td><strong>DragSortable</strong></td>
    <td>B</td>
    <td>ISG</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>DropMark</strong></td>
    <td>N</td>
    <td>G</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>Entries</strong></td>
    <td>S</td>
    <td>I</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>First</strong></td>
    <td>N</td>
    <td>ISGN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>Format</strong></td>
    <td>S</td>
    <td>ISG</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>Image</strong></td>
    <td>S</td>
    <td>I</td>
    <td><a href="list_images.html">See Images in lists</a></td>
  </tr>
  <tr>
    <td><strong>InsertPosition</strong></td>
    <td>N</td>
    <td>GN</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>List</strong></td>
    <td>S</td>
    <td>I</td>
    <td>A name of an ARexx stem where to read entries</td>
  </tr>
  <tr>
    <td><strong>MinLineHeight</strong></td>
    <td>N</td>
    <td>I</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>Names</strong></td>
    <td>S</td>
    <td>I</td>
    <td>A string of entries separated by a ,</td>
  </tr>
  <tr>
    <td><strong>NumSelected</strong></td>
    <td>N</td>
    <td>G</td>
    <td>The number of the selected entries</td>
  </tr>
  <tr>
    <td><strong>NumSort</strong></td>
    <td>B</td>
    <td>ISGN</td>
    <td>Sets numeric comparation mode (0 is the default)</td>
  </tr>
  <tr>
    <td><strong>Quiet</strong></td>
    <td>B</td>
    <td>SG</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>Separator</strong></td>
    <td>C</td>
    <td>I</td>
    <td>The char to be used as columns separator in a multi column list. Default: |</td>
  </tr>
  <tr>
    <td><strong>ShowDropMarks</strong></td>
    <td>B</td>
    <td>ISG</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
   <td><strong>SortFormat</strong></td>
    <td>S</td>
    <td>ISG</td>
    <td>Here you may specify a sort Format String to control some
    sorting options. The string may contain one entry for each
    column of the list. Entries are seperated by commas: each entry is parsed via dos.library/ReadArgs().
    The template for a single entry is<br>
    C=COL/K/N,NUM/S,CASE/S<br>
    where:
    <ul>
     <li>COL - This value adjusts the number of the current column. Defaults
     to current entry number (0,1,...)</li>
     <li>NUM - An integral number comparation is to be applied to this
     column</li>
     <li>CASE - A string case comparation is to be applied to this column</li></ul>
     Note that:
     <ol>
     <li>Default value is an empty string</li>
     <li>If one column is omitted, it's value is cleared</li>
     <li>Numeric comparation is also controlled by NumSort attribute</li>
     <li>Case comparation is also controlled by Case attribute</li>
     <li>Entries for columns that doesn't exist are ignored</li></ol>
     Example:<br>
     Let's suppose you created a List with 3 col, First, Second and
     Third, where First is to be nocase-sorted, Second is to be
     case-sorted and Third is to be num-sorted, just set (init)
     SortFormat to "CASE,,NUM"</td>
  <tr>
    <td><strong>SortType</strong></td>
    <td>M G2N</td>
    <td>ISGN</td>
    <td>Specify the sort type and order. When set, it is a string to parse with the
    template OFF/S,COL/K/N,REV/S, where
    <ul>
     <li>OFF - if present, all other fields are ignore, no sort</li>
     <li>COL - a column number: entries are sorted by the contents of this column</li>
     <li>REV - indicates reverse order</li>
    </ul>
    Note that:
    <ul>
     <li>The default is off</li>
     <li>If OFF, entries are inserted at the bottom, even if Sorted is specified (see Insert method)</li>
    </ul>
    See <a href="#Insertion">Insertion and Sorting</a></td>
  </tr>
  <tr>
    <td><strong>Title</strong></td>
    <td>S</td>
    <td>I</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><strong>Visible</strong></td>
    <td>N</td>
    <td>N</td>
    <td>&nbsp;</td>
  </tr>
</table>

<p>&nbsp;</p>

<table border="1" cellpadding="4" width="100%">
  <tr>
    <th colspan="3"><u><strong>Methods</strong></u></th>
  </tr>
  <tr>
    <th><em><strong>Name</strong></em></th>
    <th><em><strong>Parameters</strong></em></th>
    <th><em><strong>Note</strong></em></th>
  </tr>
  <tr>
    <td><strong>AddStem</strong></td>
    <td>&lt;stemName/V&gt;,[pos]</td>
    <td>Add the entries defined in <em>stem</em> to the list. <em>mode</em> is one of: <ul>
      <li>Active</li>
      <li>Default</li>
      <li>Bottom</li>
      <li>Sorted</li>
      <li>Top</li>
    </ul>
    See <a href="#Insertion">Insertion and Sorting</a>
    </td>
  </tr>
  <tr>
    <td><strong>Clear</strong></td>
    <td>&nbsp;</td>
    <td>Clear the list.</td>
  </tr>
  <tr>
    <td><strong>ClearAddStem</strong></td>
    <td>&lt;stemName/V&gt;,[pos]</td>
    <td>As AddStem, but clear the list before adding the entries<./td> <em>mode</em> is one of: <ul>
      <li>Active</li>
      <li>Default</li>
      <li>Bottom</li>
      <li>Sorted</li>
      <li>Top</li>
    </ul>
    See <a href="#Insertion">Insertion and Sorting</a>
  </tr>
  <tr>
    <td><strong>Exchange</strong></td>
    <td>&lt;entry1&gt;,&lt;entry2&gt;</td>
    <td>Exchange 2 entries. <p><em>entry1</em> is a number or one of:<ul>
      <li>Active</li>
      <li>Bottom</li>
      <li>Top</li>
    </ul>
    <p><em>entry2</em> is a number or one of:<ul>
      <li>Active</li>
      <li>Bottom</li>
      <li>Next</li>
      <li>Previous</li>
      <li>Top</li>
    </ul>
    </td>
  </tr>
  <tr>
    <td><strong>GetEntries</strong></td>
    <td>&lt;stemName&gt;</td>
    <td>The method writes in stem.num the number of the entries and in stem.0,... stem.i
    (i=stem.num-1) the entries: <pre>    call DoMethod(&quot;list&quot;,&quot;GetEntries&quot;,&quot;entries&quot;)
    do i=0 to entries.num-1
        say entries.i
    end</pre>
    </td>
  </tr>
  <tr>
    <td><strong>GetEntry</strong></td>
    <td>&lt;pos&gt;,&lt;var&gt;</td>
    <td>Get an entry. <p><em>pos</em> is a number or <em>Active</em></td>
  </tr>
  <tr>
    <td><strong>GetSelected</strong></td>
    <td>stem</td>
    <td>The method writes in stem.num the number of the selected entries and in stem.0,...
    stem.i (i=stem.num-1) the entries: <pre>    do i=0 to sel.num-1
        say sel.i
    end</pre>
    </td>
  </tr>
  <tr>
    <td><strong>GetSortType</strong></td>
    <td>&lt;var/V&gt;</td>
    <td>Get the human form of SortType value. If you read SortType, you get an integral number,
    the format of which is not even compatible with ARexx integral numbers. This methods writes
    in <em>var</em> the SortType string. See <a href="#Insertion">Insertion and Sorting</a>
    </td>
  </tr>
  <tr>
    <td><strong>Insert</strong></td>
    <td>&lt;entry&gt;, [pos]</td>
    <td>Insert an entry in a list. <p><em>pos</em> is a number or one of:<ul>
      <li>Active</li>
      <li>Bottom (Default)</li>
      <li>Sorted</li>
      <li>Top</li>
    </ul>
    </td>
  </tr>
  <tr>
    <td><strong>Jump</strong></td>
    <td>[pos]</td>
    <td>Jump to an entry, making it visible. <p><em>pos</em> is a number or one of<ul>
      <li>Active (Default)</li>
      <li>Bottom</li>
      <li>Down</li>
      <li>Top</li>
    </ul>
    </td>
  </tr>
  <tr>
    <td><strong>Remove</strong></td>
    <td>[pos]</td>
    <td>Remove an entry. <p><em>pos</em> is a number or one of<ul>
      <li>Active (Default)</li>
      <li>First</li>
      <li>Last</li>
      <li>Selected</li>
    </ul>
    </td>
  </tr>
  <tr>
    <td><strong>ReplaceCol</strong></td>
    <td>&lt;pos&gt;,&lt;col&gt;,&lt;value&gt;</td>
    <td>Replace the contents of the <em>col</em> column of the <em>pos</em> entry with <em>value</em>.
    <p><em>pos</em> is a number of <em>Active</em>.</td>
  </tr>
  <tr>
    <td><strong>Select</strong></td>
    <td>[pos],[type],[var/S]</td>
    <td>Select entries. <p><em>pos</em> is a number or one of:<ul>
      <li>Active (Default)</li>
      <li>All</li>
    </ul>
    <p><em>type</em> is a number or one of:<ul>
      <li>Ask</li>
      <li>On</li>
      <li>Off</li>
      <li>Toggle (Default)</li>
    </ul>
    <p>If <em>type</em> is <em>Ask</em> the third argument must be supplied and must be a
    valid ARexx var name: it will contain the number of the selected entries.</td>
  </tr>
  <tr>
    <td><strong>Sort</strong></td>
    <td>&nbsp;</td>
    <td>Sort the entries of the list. See <a href="#Insertion">Insertion and Sorting</a></td>
  </tr>
</table>

<p>&nbsp;</p>

<p><b><a name="Insertion">Insertion and sorting</a></b></p>

<p>Insertion means <em>adding entries at init time</em> and <em>adding entries with AddStem and ClearAddStem methods</em>.</p>

<p>Insertion is ruled by the following attributes:</p>
<ol>
 <li>DefaultInsertPos</li>
 <li>DragSortable</li>
</ol>

<p>At init time, if DefaultInsertPos is specified and it is not Default, entries are inserted at the position
specified, otherwise: if DragSortable is 1, entries are inserted Sorted, otherwise
entries are inserted at the bottom.</li>

<p>The above applies also when adding entries with AddStem and ClearAddStem.</p>

<p>Sorting is ruled by SortType and SortFormat; SortType specifies the sorting criterium: no sort, the number
of the column that rules the sort, reverse order; SortFormat specifies options for each column of the List.</p>

<p>Note that SortType default value is OFF. It means that no sorting applies so
that entries are inserted not sorted (usually at the bottom).</p>

</body>
</html>